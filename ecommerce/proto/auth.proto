// Copyright 2015 gRPC authors.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

package auth;

// folder in which all the generated go files will be stored
option go_package = "github.com/MatteoBollecchino/Distributed_Programming_Project/ecommerce/proto/auth";

enum Role {
  CLIENT = 1;
  ADMIN = 2;
}

// USER MODEL
message User {
  string username = 1;
  string password = 2;
  Role role = 3;
}

// LOGIN
message LoginRequest {
    string username = 1;
    string password = 2;
}

message LoginResponse {
    User user = 1;
    string error_message = 2;
}

// REGISTRATION
message RegisterRequest {
    string username = 1;
    string password = 2;
}

message RegisterResponse {
    string error_message = 1;
}

// PASSWORD CHANGE
message ChangePasswordRequest {
  string username = 1;
  string old_password = 2;
  string new_password = 3;
}

message ChangePasswordResponse {
    string error_message = 1;
}

// GET A SINGLE USER
message GetUserRequest {
  string username = 1;
}

message GetUserResponse {
  User user = 1;
  string error_message = 2;
}

// GET ALL USERS LIST
message GetAllUsersRequest {}

message GetAllUsersResponse {
  repeated User users = 1;
  string error_message = 2;
}

// SERVICES
service AuthenticationService {
    rpc Login(LoginRequest) returns (LoginResponse);
    rpc Register(RegisterRequest) returns (RegisterResponse);
    rpc ChangePassword(ChangePasswordRequest) returns (ChangePasswordResponse);
    rpc GetUser(GetUserRequest) returns (GetUserResponse);
    rpc GetUsers(GetUsersRequest) returns (GetUsersResponse);
}